<div>
  <h2>Your Projects</h2>
  {{#await projectList}}
    <p>Waiting for project list...</p>
  {{then projects}}
      {{#if projects.length === 0}}
        <p>You don't have any projects yet.</p>
      {{else}}
        {{#each projects as project}}
          <p class="{{currentProject && currentProject.id === project.id ? 'selected' : ''}}"
              on:click="set({ currentProject: project })">
            {{project.fields.name}}
          </p>
        {{/each}}
      {{/if}}
      <p id="new-project"
          class="{{currentProject === 'new' ? 'selected' : ''}}"
          on:click="set({ currentProject: 'new' })">
        âž• Click here to create a new project.
      </p>
  {{catch err}}
    <p>Error getting project names</p>
  {{/await}}
</div>

<style>
  div {
    max-width: 15em;
    background-color: cyan;
    padding: 1em 0;
  }

  h2 {
    text-align: center;
    font-family: "Source Serif Pro", Palatino, Georgia, serif;
  }

  p {
    min-height: 2em;
    margin: 0;
    padding: 0.5em;
    border-top: 1px solid grey;
    text-align: center;
    font-family: sans-serif;
  }

  p:hover {
    font-weight: bolder;
    background-color: steelblue;
    cursor: pointer;
  }

  #new-project {
    font-weight: bolder;
  }

  .selected {
    background-color: pink;
  }

  .selected:hover {
    background-color: deeppink;
  }
</style>

<script>
  export default {
    data() {
      return {
        projectList: fetch('/api/projects').then(res => res.json()),
      };
    },
  };
</script>
